# definições de um relatório

# arquivo com variáveis shell que definem
# a consulta SQL 

# definições obrigatórias:

# ARQUIVO
# NOMES
# CAMPOS
# TABELAS
# CONDICOES
# ORDEM

# campos especiais

LOCAL="coalesce(local_nome(o.geog), split_part(st_aslatlontext(o.geog, 'DD°C'), ' ',1)||' ('||func_area_nome(st_setsrid(o.geog,4326))||')')"

DISTANCIA_COSTA="round((st_distance(o.geog::geography, d.geog::geography)/1850.0)::numeric,1)"

# campos obrigatórios

ARQUIVO="sem_rgp.csv"

NOMES="NOME ONIXSAT, NUM MARINHA, DATA/HORA, LOCALIZAÇÃO, DISTÂNCIA DA COSTA, PROFUNDIDADE, VELOCIDADE, RUMO"
CAMPOS="o.embarcacao, c.num_marinha, o.datahora, $LOCAL, $DISTANCIA_COSTA, func_prof(st_value(g.rast,o.geog)), o.veloc, o.direcao"
TABELAS="onixsat o, gebco g, nova_chave_onixsat c, costa_cartadhn d"
CONDICOES="o.embarcacao = c.embarcacao and c.num_marinha not in (select num_marinha from raep_deferidas)"
ORDEM="1"
